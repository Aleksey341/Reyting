# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—é –ë–î –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ "–†–µ–π—Ç–∏–Ω–≥"

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ "–†–µ–π—Ç–∏–Ω–≥".

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –®–∞–≥ 1: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è leader_name)

```bash
psql -U postgres -d reyting_db -f backend/migrations/add_leader_name_to_mo.sql
```

### –®–∞–≥ 2: –ó–∞–ø–æ–ª–Ω–∏—Ç—å –§–ò–û –≥–ª–∞–≤ –ú–û

```bash
psql -U postgres -d reyting_db -f backend/migrations/sample_leader_data.sql
```

### –®–∞–≥ 3: –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```bash
psql -U postgres -d reyting_db -f etl/fill_rating_data.sql
```

## üìä –ß—Ç–æ —Å–æ–∑–¥–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç fill_rating_data.sql

### 1. –ü–µ—Ä–∏–æ–¥ 2024-01
- –°–æ–∑–¥–∞–µ—Ç –ø–µ—Ä–∏–æ–¥ —Å –¥–∞—Ç–∞–º–∏ 2024-01-01 –ø–æ 2024-01-31
- –¢–∏–ø: 'month'

### 2. –ú–µ—Ç–æ–¥–∏–∫–∞ v1.0
- –°–æ–∑–¥–∞–µ—Ç –±–∞–∑–æ–≤—É—é –≤–µ—Ä—Å–∏—é –º–µ—Ç–æ–¥–∏–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –±–∞–ª–ª–æ–≤

### 3. –ö—Ä–∏—Ç–µ—Ä–∏–∏ (1-17)
–°–æ–∑–¥–∞–µ—Ç 17 –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π:
- **–ö—Ä–∏—Ç–µ—Ä–∏–∏ 1-3**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- **–ö—Ä–∏—Ç–µ—Ä–∏–∏ 4-6**: –≠–∫–æ–Ω–æ–º–∏–∫–∞
- **–ö—Ä–∏—Ç–µ—Ä–∏–∏ 7-8**: –°–æ—Ü–∏–∞–ª—å–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞
- **–ö—Ä–∏—Ç–µ—Ä–∏–∏ 9-11**: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **–ö—Ä–∏—Ç–µ—Ä–∏–∏ 12-13**: –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
- **–ö—Ä–∏—Ç–µ—Ä–∏–∏ 14-16**: –ó–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
- **–ö—Ä–∏—Ç–µ—Ä–∏–π 17**: –ö—É–ª—å—Ç—É—Ä–∞

### 4. –®—Ç—Ä–∞—Ñ—ã (18-21)
–°–æ–∑–¥–∞–µ—Ç 4 —Ç–∏–ø–∞ —à—Ç—Ä–∞—Ñ–æ–≤:
- **–®—Ç—Ä–∞—Ñ 18**: –ù–∞—Ä—É—à–µ–Ω–∏–µ –≤ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏
- **–®—Ç—Ä–∞—Ñ 19**: –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º
- **–®—Ç—Ä–∞—Ñ 20**: –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é
- **–®—Ç—Ä–∞—Ñ 21**: –ù–∞—Ä—É—à–µ–Ω–∏–µ –±—é–¥–∂–µ—Ç–Ω–æ–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã

### 5. –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –ú–û
–ó–∞–ø–æ–ª–Ω—è–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ú–û:
- –ë–∞–ª–ª—ã –∑–∞ 17 –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤
- –®—Ç—Ä–∞—Ñ–Ω—ã–µ –±–∞–ª–ª—ã
- –ò—Ç–æ–≥–æ–≤—ã–π –±–∞–ª–ª
- –ó–æ–Ω–∞ (green/yellow/red)

**–ü—Ä–∏–º–µ—Ä –±–∞–ª–ª–æ–≤ –ø–æ –ú–û:**
```
–õ–∏–ø–µ—Ü–∫         ‚Üí 61 –±–∞–ª–ª ‚Üí –ó–µ–ª—ë–Ω–∞—è –∑–æ–Ω–∞ (53-66)
–ï–ª–µ—Ü           ‚Üí 56 –±–∞–ª–ª–æ–≤ ‚Üí –ó–µ–ª—ë–Ω–∞—è –∑–æ–Ω–∞
–í–æ–ª–æ–≤—Å–∫–∏–π      ‚Üí 56 –±–∞–ª–ª–æ–≤ ‚Üí –ó–µ–ª—ë–Ω–∞—è –∑–æ–Ω–∞
–ì—Ä—è–∑–∏–Ω—Å–∫–∏–π     ‚Üí 52 –±–∞–ª–ª–∞ ‚Üí –ñ—ë–ª—Ç–∞—è –∑–æ–Ω–∞ (29-52)
–î–∞–Ω–∫–æ–≤—Å–∫–∏–π     ‚Üí 48 –±–∞–ª–ª–æ–≤ ‚Üí –ñ—ë–ª—Ç–∞—è –∑–æ–Ω–∞
–î–æ–±—Ä–∏–Ω—Å–∫–∏–π     ‚Üí 36 –±–∞–ª–ª–æ–≤ ‚Üí –ñ—ë–ª—Ç–∞—è –∑–æ–Ω–∞
–î–æ–±—Ä–æ–≤—Å–∫–∏–π     ‚Üí 34 –±–∞–ª–ª–∞ ‚Üí –ñ—ë–ª—Ç–∞—è –∑–æ–Ω–∞
–î–æ–ª–≥–æ—Ä—É–∫–æ–≤—Å–∫–∏–π ‚Üí 34 –±–∞–ª–ª–∞ ‚Üí –ñ—ë–ª—Ç–∞—è –∑–æ–Ω–∞
–û—Å—Ç–∞–ª—å–Ω—ã–µ      ‚Üí 25-34 –±–∞–ª–ª–∞ ‚Üí –ö—Ä–∞—Å–Ω–∞—è –∑–æ–Ω–∞ (0-28)
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ë–î –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ:

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥ –≤ –ë–î:
```sql
SELECT
    mo.mo_name,
    mo.leader_name,
    s.score_total,
    s.zone
FROM fact_summary s
JOIN dim_mo mo ON s.mo_id = mo.mo_id
WHERE s.period_id = (SELECT period_id FROM dim_period WHERE date_from = '2024-01-01'::date LIMIT 1)
ORDER BY s.score_total DESC;
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API:
```bash
curl "http://localhost:8000/api/rating?period=2024-01&sort=score_total&page=1"
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Frontend:
1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5173
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–†–µ–π—Ç–∏–Ω–≥"
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏

## üìù –î–µ—Ç–∞–ª–∏ —Å–∫—Ä–∏–ø—Ç–∞

### –¢–∞–±–ª–∏—Ü–∞ fact_indicator
- 17 –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ √ó 20 –ú–û = 340 –∑–∞–ø–∏—Å–µ–π
- –ë–∞–ª–ª—ã –æ—Ç 0 –¥–æ 5 –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ú–û
- –°–≤—è–∑—å: mo_id, period_id, ind_id, version_id

### –¢–∞–±–ª–∏—Ü–∞ fact_penalty
- 4 —à—Ç—Ä–∞—Ñ–∞ √ó –Ω–µ—Å–∫–æ–ª—å–∫–æ –ú–û = ~8-12 –∑–∞–ø–∏—Å–µ–π
- –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –±–∞–ª–ª—ã (-1, -2 –∏ —Ç.–¥.)
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ –ú–û —Å –Ω–∞—Ä—É—à–µ–Ω–∏—è–º–∏

### –¢–∞–±–ª–∏—Ü–∞ fact_summary
- 1 –∑–∞–ø–∏—Å—å –Ω–∞ –∫–∞–∂–¥–æ–µ –ú–û –∑–∞ –ø–µ—Ä–∏–æ–¥
- –°–æ–¥–µ—Ä–∂–∏—Ç: score_public, score_closed, score_penalties, score_total, zone
- **–ì–õ–ê–í–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –î–õ–Ø –†–ï–ô–¢–ò–ù–ì–ê**

## ‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:

### –ò–∑–º–µ–Ω–∏—Ç—å –±–∞–ª–ª—ã –∑–∞ –∫—Ä–∏—Ç–µ—Ä–∏–∏:
–ù–∞–π–¥–∏—Ç–µ –≤ —Å–∫—Ä–∏–ø—Ç–µ —Å–µ–∫—Ü–∏—é "5. –û–ß–ò–°–¢–ò–¢–¨ –ò –ó–ê–ü–û–õ–ù–ò–¢–¨ FACT_INDICATOR" –∏ –∏–∑–º–µ–Ω–∏—Ç–µ CASE –≤—ã—Ä–∞–∂–µ–Ω–∏—è.

### –ò–∑–º–µ–Ω–∏—Ç—å —à—Ç—Ä–∞—Ñ—ã:
–ù–∞–π–¥–∏—Ç–µ –≤ —Å–∫—Ä–∏–ø—Ç–µ —Å–µ–∫—Ü–∏—é "6. –û–ß–ò–°–¢–ò–¢–¨ –ò –ó–ê–ü–û–õ–ù–ò–¢–¨ FACT_PENALTY" –∏ –∏–∑–º–µ–Ω–∏—Ç–µ —É—Å–ª–æ–≤–∏—è.

### –ò–∑–º–µ–Ω–∏—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã –∑–æ–Ω:
–ù–∞–π–¥–∏—Ç–µ –≤ —Å–∫—Ä–∏–ø—Ç–µ CASE –¥–ª—è `zone` –≤ —Å–µ–∫—Ü–∏–∏ "7. –ó–ê–ü–û–õ–ù–ò–¢–¨ FACT_SUMMARY":
```sql
CASE
    WHEN ... >= 53 THEN 'green'    -- –ó–µ–ª—ë–Ω–∞—è: 53-66
    WHEN ... >= 29 THEN 'yellow'   -- –ñ—ë–ª—Ç–∞—è: 29-52
    ELSE 'red'                     -- –ö—Ä–∞—Å–Ω–∞—è: 0-28
END
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–ê–ñ–ù–û**: –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ. –ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤ production:
1. –ò–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ—Ç–æ–¥–∏–∫–µ —Ä–∞—Å—á–µ—Ç–∞
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –§–ò–û –≥–ª–∞–≤ –ú–û
4. –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ –≤ dev/staging –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –ø–µ—Ä–µ–¥ production

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "–¢–∞–±–ª–∏—Ü–∞ fact_summary —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, —Å–∫—Ä–∏–ø—Ç —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–µ

### –û—à–∏–±–∫–∞: "–ü–µ—Ä–∏–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω"
- –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ø–µ—Ä–∏–æ–¥ 2024-01
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ dim_period —Ç–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

### –û—à–∏–±–∫–∞: "–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω"
- –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç 17 –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ dim_indicator —Ç–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

### API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –≤ fact_summary
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥: `?period=2024-01`

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ PostgreSQL
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π SQL –∑–∞–ø—Ä–æ—Å
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ backend –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω –ø–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ë–î

## üìÖ –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π

| –í–µ—Ä—Å–∏—è | –î–∞—Ç–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|------|---------|
| 1.0 | 2024-11-16 | –ü–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è —Å–∫—Ä–∏–ø—Ç–∞ —Å –±–∞–∑–æ–≤—ã–º–∏ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ |

---

**–°–æ–∑–¥–∞–Ω–æ:** 16 –Ω–æ—è–±—Ä—è 2024
**–í–µ—Ä—Å–∏—è –º–µ—Ç–æ–¥–∏–∫–∏:** v1.0
**–ü–µ—Ä–∏–æ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** 2024-01
