# üõ†Ô∏è –ê–¥–º—ñ–Ω E–Ω–¥–ø–æ—ó–Ω—Ç–∏: –ö–µ—Ä—É–≤–∞–Ω–Ω—è –î–∞–Ω–∏–º–∏ –†–µ–π—Ç–∏–Ω–≥—É

## ‚úÖ –ü—Ä–æ–±–ª–µ–º–∏, —è–∫—ñ –≤–∏—Ä—ñ—à–µ–Ω—ñ

1. **API docs —Ç–µ–ø–µ—Ä —Å–æ–¥–µ—Ä–∂–∞—Ç –µ–Ω–¥–ø–æ—ó–Ω—Ç–∏ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –§–Ü–û –≥–ª–∞–≤ –ú–û**
   - –ï–Ω–¥–ø–æ—ó–Ω—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ –∑–∞ –∞–¥—Ä–µ—Å–æ—é: https://reyting-alex1976.amvera.io/api/docs#/admin

2. **–ù–æ–≤—ñ –µ–Ω–¥–ø–æ—ó–Ω—Ç–∏ –¥–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –≤ –±–∞–∑—ñ**
   - –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –§–Ü–û –≥–ª–∞–≤ –ú–û
   - –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤ —ñ —à—Ç—Ä–∞—Ñ–Ω–∏—Ö –±–∞–ª—ñ–≤
   - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É –ë–î

3. **–¢–∞–±–ª–∏—Ü—è –≤ –†–µ–π—Ç–∏–Ω–≥—É –±—ñ–ª—å—à–µ –Ω–µ –±—É–¥–µ –ø–æ—Ä–æ–∂–Ω—å–æ—é**
   - –ü—ñ—Å–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è fact_indicator –¥–∞–Ω–∏–º–∏

---

## üöÄ –ù–æ–≤—ã–µ —ç–Ω–¥–ø–æ–π–Ω—Ç—ã

### 1. GET /api/admin/db-status
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ë–î - —Å–∫–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≥—Ä—É–∂–µ–Ω–æ

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://reyting-alex1976.amvera.io/api/docs
2. –ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª `admin`
3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç `GET /admin/db-status`
4. –ù–∞–∂–º–∏—Ç–µ "Try it out"
5. –ù–∞–∂–º–∏—Ç–µ "Execute"

**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏–º–µ—Ä:**
```json
{
  "status": "success",
  "database_status": {
    "total_mos": 20,
    "mos_with_leaders": 0,  // ‚Üê –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 20 –ø–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
    "total_indicators": 19,
    "total_periods": 1,
    "fact_indicators_records": 0  // ‚Üê –î–æ–ª–∂–Ω–æ –±—ã—Ç—å > 0 –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
  },
  "needs": {
    "leader_names": true,  // ‚Üê true = –Ω—É–∂–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –§–ò–û
    "indicator_data": true  // ‚Üê true = –Ω—É–∂–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
  }
}
```

---

### 2. GET /api/admin/leader-names-template
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∏—Ç—å CSV —à–∞–±–ª–æ–Ω –¥–ª—è –§–ò–û –≥–ª–∞–≤

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://reyting-alex1976.amvera.io/api/docs#/admin
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ `GET /admin/leader-names-template`
3. –ù–∞–∂–º–∏—Ç–µ "Try it out" ‚Üí "Execute"
4. –í –æ—Ç–≤–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç–µ CSV —Ç–µ–∫—Å—Ç
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ–≥–æ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä (Notepad)
6. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫: `leader_names.csv` —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π **UTF-8**

**–§–æ—Ä–º–∞—Ç CSV:**
```
–ú–û,–§–ò–û –≥–ª–∞–≤—ã
–õ–∏–ø–µ—Ü–∫,–ß–µ–Ω—Ü–æ–≤ –†.–ò.
–ï–ª–µ—Ü,–ñ–∞–±–∏–Ω –í.–ü.
–í–æ–ª–æ–≤—Å–∫–∏–π,–©–µ–≥–ª–æ–≤ –°.–°.
...
```

---

### 3. POST /api/admin/upload-leader-names
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∏—Ç—å CSV —Ñ–∞–π–ª —Å –§–ò–û –≥–ª–∞–≤

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
1. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ CSV —Ñ–∞–π–ª (—Å–∫–∞—á–∞–π—Ç–µ —à–∞–±–ª–æ–Ω –≤—ã—à–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)
2. –û—Ç–∫—Ä–æ–π—Ç–µ: https://reyting-alex1976.amvera.io/api/docs#/admin
3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ `POST /admin/upload-leader-names`
4. –ù–∞–∂–º–∏—Ç–µ "Try it out"
5. –í –ø–æ–ª–µ "file" –Ω–∞–∂–º–∏—Ç–µ "Choose File"
6. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à CSV —Ñ–∞–π–ª
7. –ù–∞–∂–º–∏—Ç–µ "Execute"

**–û—Ç–≤–µ—Ç –Ω–∞ —É—Å–ø–µ—Ö:**
```json
{
  "status": "success",
  "message": "Updated 20 leader names",
  "updated_count": 20
}
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –§—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç LIKE –¥–ª—è –ø–æ–∏—Å–∫–∞ –ú–û –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –ø–æ—ç—Ç–æ–º—É —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –µ—Å–ª–∏ —Ç–æ—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –Ω–µ—Ç.

---

### 4. POST /api/admin/populate-test-data
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–ø–æ–ª–Ω–∏—Ç—å fact_indicator —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –∏ —à—Ç—Ä–∞—Ñ–æ–≤

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://reyting-alex1976.amvera.io/api/docs#/admin
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ `POST /admin/populate-test-data`
3. –ù–∞–∂–º–∏—Ç–µ "Try it out"
4. –í –ø–∞—Ä–∞–º–µ—Ç—Ä–µ `period` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å—Ç–æ–∏—Ç `2024-01` - –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –¥—Ä—É–≥–æ–π –º–µ—Å—è—Ü
5. –ù–∞–∂–º–∏—Ç–µ "Execute"

**–û—Ç–≤–µ—Ç –Ω–∞ —É—Å–ø–µ—Ö:**
```json
{
  "status": "success",
  "message": "Populated test data for period 2024-01",
  "inserted_records": 380,  // 20 –ú–û √ó 19 –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π = 380 –∑–∞–ø–∏—Å–µ–π
  "mos_count": 20,
  "indicators_count": 19
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –°–æ–∑–¥–∞–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥ 2024-01 (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
- –°–æ–∑–¥–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è v1.0 (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ú–û √ó –∫–∞–∂–¥–æ–≥–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è —Å–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å —Å —Ç–µ—Å—Ç–æ–≤—ã–º –±–∞–ª–ª–æ–º
- –ë–∞–ª–ª—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ: `(mo_id * 7 + indicator_index * 13) % 100`, –∑–∞—Ç–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è –Ω–∞ 0-10

---

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ë–î

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ë–î
```
GET /api/admin/db-status
```
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `mos_with_leaders` –∏ `fact_indicators_records` —Ä–∞–≤–Ω—ã 0 (–Ω—É–∂–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å).

### –®–∞–≥ 2: –ó–∞–ø–æ–ª–Ω–∏—Ç—å –§–ò–û –≥–ª–∞–≤ –ú–û
**–í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ API Upload**
1. `GET /api/admin/leader-names-template` - —Å–∫–∞—á–∞—Ç—å —à–∞–±–ª–æ–Ω
2. `POST /api/admin/upload-leader-names` - –∑–∞–≥—Ä—É–∑–∏—Ç—å CSV —Ñ–∞–π–ª

**–í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ SQL –Ω–∞ Amvera console (–µ—Å–ª–∏ –∑–Ω–∞–µ—Ç–µ SQL)**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π–ª: `backend/migrations/APPLY_LEADER_NAMES_NOW.sql`

### –®–∞–≥ 3: –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
```
POST /api/admin/populate-test-data?period=2024-01
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```
GET /api/admin/db-status
```
–¢–µ–ø–µ—Ä—å –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
- `mos_with_leaders`: 20
- `fact_indicators_records`: 380

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- –û—Ç–∫—Ä–æ–π—Ç–µ: https://reyting-alex1976.amvera.io/
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–†–µ–π—Ç–∏–Ω–≥"
- –î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è —Ç–∞–±–ª–∏—Ü–∞ —Å:
  - –°—Ç–æ–ª–±—Ü–æ–º –ú–û
  - –°—Ç–æ–ª–±—Ü–æ–º –§–ò–û –≥–ª–∞–≤
  - –°—Ç–æ–ª–±—Ü–∞–º–∏ —Å –±–∞–ª–ª–∞–º–∏ (1-19)
  - –ò—Ç–æ–≥–æ–≤—ã–º –±–∞–ª–ª–æ–º —Å —Ü–≤–µ—Ç–æ–≤–æ–π —Ä–∞–∑–º–µ—Ç–∫–æ–π

---

## üîç –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (cURL)

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ë–î
```bash
curl -X GET "https://reyting-alex1976.amvera.io/api/admin/db-status"
```

### –ó–∞–ø–æ–ª–Ω–∏—Ç—å –§–ò–û –∏–∑ CSV
```bash
curl -X POST "https://reyting-alex1976.amvera.io/api/admin/upload-leader-names" \
  -F "file=@leader_names.csv"
```

### –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
```bash
curl -X POST "https://reyting-alex1976.amvera.io/api/admin/populate-test-data?period=2024-01"
```

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "Connection refused" –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ —ç–Ω–¥–ø–æ–π–Ω—Ç–∞–º

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Amvera
2. –î–æ–∂–¥–∏—Ç–µ—Å—å –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–æ–±—ã—á–Ω–æ 30-60 —Å–µ–∫—É–Ω–¥)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ ALLOWED_ORIGINS –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: "404 Not Found" –¥–ª—è —ç–Ω–¥–ø–æ–π–Ω—Ç–æ–≤ /api/admin

**–†–µ—à–µ–Ω–∏–µ:**
- –≠–Ω–¥–ø–æ–π–Ω—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∫–æ–º–º–∏—Ç–µ `5d161cc`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ Amvera:
  ```bash
  git log --oneline | grep "admin"
  ```
- –ï—Å–ª–∏ –Ω–µ—Ç - –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

### –ü—Ä–æ–±–ª–µ–º–∞: CSV –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª –∫–æ–¥–∏—Ä–æ–≤–∞–Ω –≤ **UTF-8** (–Ω–µ ANSI)
2. –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å - –∑–∞–ø—è—Ç–∞—è (`,`)
3. –§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 2 —Å—Ç–æ–ª–±—Ü–∞: –ú–û –∏ –§–ò–û –≥–ª–∞–≤—ã
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ - —ç—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: –î–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ—è–≤–∏–ª–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ –†–µ–π—Ç–∏–Ω–≥

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞: `Ctrl+Shift+Delete`
2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É: `Ctrl+F5`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ `F12 ‚Üí Network ‚Üí GET /api/rating`:
   - –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞ 200 (—É—Å–ø–µ—Ö)
   - –í –æ—Ç–≤–µ—Ç–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–ª—è `leader_name` –∏ `blocks`

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–í—Å–µ —ç–Ω–¥–ø–æ–π–Ω—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ: `backend/routes/admin_routes.py`

–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª–µ: `backend/main.py` (—Å—Ç—Ä–æ–∫–∞ 139)

–í–∏–¥–Ω—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏: https://reyting-alex1976.amvera.io/api/docs#/admin
