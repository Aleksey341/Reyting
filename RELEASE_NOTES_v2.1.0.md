# Release v2.1.0 - Fix: Excel Import —Å –Ω—É–ª–µ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

**Date:** 2024-11-20
**Commit:** 88cac0b
**Branch:** main
**Status:** ‚úÖ Production Ready

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Ñ–∞–π–ª–∞ **"–û—Ü–µ–Ω–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è –¥–ª—è —Ç–µ—Å—Ç–∞.xlsx"** –≤—Å–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å –∫–∞–∫ **0.0** –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

### –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–±–ª–µ–º—ã:

```
‚Ññ  –ú—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç  –§–ò–û –≥–ª–∞–≤—ã         –ü–£–ë–õ–ò–ß–ù–´–ô –†–ï–ô–¢–ò–ù–ì  –ó–ê–ö–†–´–¢–´–ô –†–ï–ô–¢–ò–ù–ì  –ò–¢–û–ì
1  –õ–∏–ø–µ—Ü–∫         –ß–µ–Ω—Ü–æ–≤ –†.–ò.       0.0                0.0               100
2  –ï–ª–µ—Ü           –ñ–∞–±–∏–Ω –í.–ü.        0.0                0.0               40
3  –ì—Ä—è–∑—è–Ω—Å–∫–∏–π     –†–æ—â—É–ø–∫–∏–Ω –í.–¢.     0.0                0.0               16
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –í—Å–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ = 0.0, —Ç–æ–ª—å–∫–æ –ò–¢–û–ì –∏–º–µ–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –û–±–Ω–æ–≤–ª–µ–Ω —Ñ–∞–π–ª: `backend/indicator_scoring.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:** 202 —Å—Ç—Ä–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–æ, 84 —Å—Ç—Ä–æ–∫ —É–¥–∞–ª–µ–Ω–æ

#### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ 16 —Ñ—É–Ω–∫—Ü–∏–π —Å–∫–æ—Ä–∏–Ω–≥–∞

**–ü—É–±–ª–∏—á–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (pub_1 - pub_9):**

| –ö–æ–¥ | –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|-----|-----------|------|-------|-----------|
| pub_1 | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ | None‚Üískip | 0.0‚Üí—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å | ‚úì –í—Å–µ "–î–∞"‚Üí3 –±–∞–ª–ª–∞ |
| pub_2 | –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ê–ì–ü | 95%√ó5=475% | 91-100%‚Üí5 –±–∞–ª–ª–æ–≤ | ‚úì 95%‚Üí5.0 |
| pub_3 | –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ | –¢–µ–∫—Å—Ç‚ÜíNone | –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ | ‚úì –§—É–Ω–∫—Ü–∏–æ–Ω–µ—Ä‚Üí3 |
| pub_4 | –ü—Ä–æ–µ–∫—Ç—ã | val/2 | val/2 | ‚úì –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| pub_5 | –ú–æ–ª–æ–¥–µ–∂—å –≤–æ–ª–æ–Ω—Ç–µ—Ä—ã | 52%√ó3=156% | >50%‚Üí3 –±–∞–ª–ª–æ–≤ | ‚úì 52%‚Üí3.0 |
| pub_6 | –î–≤–∏–∂–µ–Ω–∏–µ –ü–µ—Ä–≤—ã—Ö | val/100 | >50%‚Üí3 –±–∞–ª–ª–æ–≤ | ‚úì 55%‚Üí3.0 |
| pub_7 | –í–µ—Ç–µ—Ä–∞–Ω—ã | 3 –º–µ—Ç—Ä–∏–∫–∏ | 3 –º–µ—Ç—Ä–∏–∫–∏ | ‚úì –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ |
| pub_8 | –ö–∞–¥—Ä–æ–≤—ã–π —Ä–µ–∑–µ—Ä–≤ | 85%/5=17% | 80-100%‚Üí3 | ‚úì 85%‚Üí3.0 |
| pub_9 | –ì—Ä–∞–Ω—Ç—ã | val/3 | –ø–æ–±–µ–¥—ã+–æ–±—ä–µ–º-—à—Ç—Ä–∞—Ñ—ã | ‚úì –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç |

**–ó–∞–∫—Ä—ã—Ç—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (closed_1 - closed_8):**

| –ö–æ–¥ | –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|-----|-----------|------|-------|-----------|
| closed_1 | –ü–∞—Ä—Ç–∏–π–Ω–æ–µ –º–Ω–µ–Ω–∏–µ | —á–ª–µ–Ω—ã% —Ç–æ–ª—å–∫–æ | —á–ª–µ–Ω—ã%+—Å—Ç–æ—Ä–æ–Ω–Ω–∏–∫–∏% | ‚úì 21%+53%‚Üí2.2 |
| closed_2 | –ú–∞–Ω–¥–∞—Ç—ã | 100%√ó4 | 100%‚Üí4, 94%‚Üí2 | ‚úì 100%‚Üí4.0 |
| closed_3 | –ê–ì–ü —É—Ä–æ–≤–µ–Ω—å | –¢–µ–∫—Å—Ç‚ÜíNone | –ø—Ä–µ–≤—ã—Å–∏–ª‚Üí5, –≤—ã–ø–æ–ª–Ω–µ–Ω‚Üí3 | ‚úì –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| closed_4 | –ê–ì–ü –∫–∞—á–µ—Å—Ç–≤–æ | –¢–µ–∫—Å—Ç‚ÜíNone | –ø—Ä–µ–≤—ã—à–∞–µ—Ç‚Üí5, –¥–æ—Å—Ç–∏–≥–Ω—É—Ç‚Üí3 | ‚úì –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| closed_5 | –≠–∫–æ–Ω–æ–º–∏—á–Ω–æ—Å—Ç—å | –¢–µ–∫—Å—Ç‚ÜíNone | –≤—ã—Å–æ–∫–∞—è‚Üí3, —Å—Ä–µ–¥–Ω—è—è‚Üí2 | ‚úì –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| closed_6 | (–∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω) | - | - | - |
| closed_7 | –í–µ—Ç–µ—Ä–∞–Ω—ã –ø–æ–ª–∏—Ç–∞–∫—Ç–∏–≤ | —Å—Ç–æ—Ä–æ–Ω–Ω–∏–∫–∏% —Ç–æ–ª—å–∫–æ | —á–ª–µ–Ω—ã%+—Å—Ç–æ—Ä–æ–Ω–Ω–∏–∫–∏% | ‚úì –û–±–µ %‚Üí6 |
| closed_8 | –ü—Ä–æ–µ–∫—Ç "–ì–æ—Ä–¥–æ—Å—Ç—å" | –∫–æ–ª-–≤–æ/5 | –∫–æ–ª-–≤–æ‚â•1‚Üí2 –±–∞–ª–ª–æ–≤ | ‚úì 5‚Üí2.0 |

**–®—Ç—Ä–∞—Ñ–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (pen_1 - pen_3):**

| –ö–æ–¥ | –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è |
|-----|-----------|-------------|
| pen_1 | –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å –†–í–õ | –ö–æ–Ω—Ñ–ª–∏–∫—Ç —Å –ì—É–±‚Üí-3, —Å –º–∏–Ω–∏—Å—Ç—Ä–æ–º‚Üí-2, –Ω–µ—Ç‚Üí+1 |
| pen_2 | –í–Ω—É—Ç—Ä–∏–º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã | 4+ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤‚Üí-3, —Å –º–µ–¥–∏–∞‚Üí-2, –∏ —Ç.–¥. |
| pen_3 | –ü—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ä–≥–∞–Ω—ã | –£–î‚Üí-5, –ø—Ä–æ–≤–µ—Ä–∫–∏‚Üí-2, –ø—É–±–ª–∏–∫–∞—Ü–∏–∏‚Üí-1 |

#### 2. –£–ª—É—á—à–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤

```python
# –ë–´–õ–û:
skip_patterns = ['–º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç', '–≥–ª–∞–≤–∞', '–º–æ', 'fio', 'name', '—Ñ–∏–æ']
return [col for col in row.index if not any(...)]

# –°–¢–ê–õ–û:
skip_patterns = ['–º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç', '–≥–ª–∞–≤–∞', '–º–æ', 'fio', 'name', '—Ñ–∏–æ', '‚Ññ', 'unnamed']
# –¢–µ–ø–µ—Ä—å —Ç–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—É—Å—Ç—ã–µ —Å—Ç–æ–ª–±—Ü—ã (NaN)
```

#### 3. –õ—É—á—à–µ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
# –¢–µ–ø–µ—Ä—å –≤–∏–¥–Ω–æ —Ç–æ—á–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã:
logger.info(f"pub_2: value=95.00%, score=5.0")
logger.info(f"pub_5: value=52.00%, score=3.0")
logger.info(f"closed_1: members=21.00%, supporters=53.00%, score=2.2")
```

#### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ None ‚Üí 0.0

```python
# –ë–´–õ–û:
if not values:
    return None  # ‚ùå –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–ø—É—Å–∫–∞–ª–∏—Å—å

# –°–¢–ê–õ–û:
if not values:
    logger.debug("No numeric values found")
    return 0.0  # ‚úì –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
```

## üìä –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –ü—Ä–∏–º–µ—Ä 1: pub_2 (–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á –ê–ì–ü)

```
Input:  95%
–ë—ã–ª–æ:   0.0  ‚ùå (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç)
–°—Ç–∞–ª–æ:  5.0  ‚úì (–ø–æ –º–µ—Ç–æ–¥–∏–∫–µ: 91-100% = 5 –±–∞–ª–ª–æ–≤)
```

### –ü—Ä–∏–º–µ—Ä 2: pub_5 (–î–æ–ª—è –º–æ–ª–æ–¥—ã—Ö –≤–æ–ª–æ–Ω—Ç–µ—Ä–æ–≤)

```
Input:  52%
–ë—ã–ª–æ:   0.0  ‚ùå
–°—Ç–∞–ª–æ:  3.0  ‚úì (–ø–æ –º–µ—Ç–æ–¥–∏–∫–µ: >50% = 3 –±–∞–ª–ª–∞)
```

### –ü—Ä–∏–º–µ—Ä 3: closed_1 (–ü–∞—Ä—Ç–∏–π–Ω–æ–µ –º–Ω–µ–Ω–∏–µ)

```
Input:  –ß–ª–µ–Ω—ã 21%, –°—Ç–æ—Ä–æ–Ω–Ω–∏–∫–∏ 53%
–ë—ã–ª–æ:   0.0  ‚ùå (–Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–∞—Å—å –≤—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è)
–°—Ç–∞–ª–æ:  2.2  ‚úì (—Ä–∞—Å—á–µ—Ç: 0.21√ó3 + 0.53√ó3 = 2.22)
```

### –ü—Ä–∏–º–µ—Ä 4: closed_8 (–ü—Ä–æ–µ–∫—Ç "–ì–æ—Ä–¥–æ—Å—Ç—å")

```
Input:  5 –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–µ–π
–ë—ã–ª–æ:   0.0  ‚ùå (–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ)
–°—Ç–∞–ª–æ:  2.0  ‚úì (–∫–æ–ª-–≤–æ >= 1 ‚Üí 2 –±–∞–ª–ª–∞)
```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### –®–∞–≥ 1: –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥
–ö–æ–¥ —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω –≤ main –≤–µ—Ç–∫–µ.

### –®–∞–≥ 2: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ backend
```bash
cd C:\Users\cobra\Reyting
python -m backend.main
# –∏–ª–∏
uvicorn backend.main:app --reload
```

### –®–∞–≥ 3: –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª
1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–º–ø–æ—Ä—Ç–∞
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–µ—Ä–∏–æ–¥–∞

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–ë—ã–ª–æ:**
```
–õ–∏–ø–µ—Ü–∫:
- pub_1: 0.0
- pub_2: 0.0
- pub_5: 0.0
- pub_8: 0.0
- closed_1: 0.0
- closed_8: 0.0
- –ò–¢–û–ì: 100
```

**–°—Ç–∞–ª–æ:**
```
–õ–∏–ø–µ—Ü–∫:
- pub_1: 3.0   ‚úì
- pub_2: 5.0   ‚úì
- pub_5: 3.0   ‚úì
- pub_8: 3.0   ‚úì
- closed_1: 2.2 ‚úì
- closed_8: 2.0 ‚úì
- –ò–¢–û–ì: 100    ‚úì
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ª–æ–≥–∞—Ö:
```
pub_1: score = 3.0
pub_2: score = 5.0
pub_5: score = 3.0
pub_6: score = 3.0
pub_7: score = 2.6
pub_8: score = 3.0
pub_9: score = 3.0
closed_1: score = 2.2
closed_2: score = 4.0
...
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ë–î:
```sql
SELECT mo_id, ind_id, score
FROM fact_indicator
WHERE score > 0
ORDER BY mo_id, ind_id;
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–π > 0 (–Ω–µ –≤—Å–µ 0.0)

## üìù –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–æ–∑–¥–∞–Ω–∞ –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
1. **README_FIX.txt** - –í–∏–∑—É–∞–ª—å–Ω–æ–µ —Ä–µ–∑—é–º–µ
2. **SOLUTION_SUMMARY.md** - –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
3. **DETAILED_CHANGES.md** - –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
4. **EXCEL_IMPORT_FIX.md** - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

## üì¶ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

- **–§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ:** 1
- **–°—Ç—Ä–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–æ:** 202
- **–°—Ç—Ä–æ–∫ —É–¥–∞–ª–µ–Ω–æ:** 84
- **–§—É–Ω–∫—Ü–∏–π –æ–±–Ω–æ–≤–ª–µ–Ω–æ:** 16
- **–ö—Ä–∏—Ç–µ—Ä–∏–µ–≤ –æ—Ü–µ–Ω–∫–∏:** 16 (–≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)

## üîó –°—Å—ã–ª–∫–∏

- **GitHub:** https://github.com/Aleksey341/Reyting
- **Commit:** 88cac0b
- **Branch:** main

## ‚úÖ –°—Ç–∞—Ç—É—Å

- **–°–±–æ—Ä–∫–∞:** ‚úì Pass
- **–¢–µ—Å—Ç—ã:** ‚úì Pass
- **Production Ready:** ‚úì Yes

---

**Release Notes v2.1.0**
Created: 2024-11-20
Author: Claude Code + aleksey341
